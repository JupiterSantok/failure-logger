<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Failure Logger</title>
    <link rel="stylesheet" href="styles.css">
    <link rel="icon" type="image/png" href="fav icon.png">
    <!-- Include SheetJS library -->
    <script src="https://cdnjs.cloudflare.com/ajax/libs/xlsx/0.17.5/xlsx.full.min.js"></script>
</head>
<body>
    <div class="container">
        <h1>Failure Logger</h1>
        
        <!-- Form for logging failures -->
        <form id="failureForm">
            <label for="testerId">Tester ID:</label>
            <input type="text" id="testerId" name="testerId" required>
            
            <label for="mtfBin">MTF Bin:</label>
            <input type="text" id="mtfBin" name="mtfBin" required>
            
            <label for="testName">Test Name:</label>
            <input type="text" id="testName" name="testName" required>
            
            <label for="testNumber">Test Number:</label>
            <input type="number" id="testNumber" name="testNumber" required>
    
            <label for="dietype">Die type:</label>
            <input type="text" id="dietype" name="dietype" required>
            
            <label for="jobReason">Job Reason:</label>
            <select id="jobReason" name="jobReason" required>
                <option value="HARDWARE">HARDWARE</option>
                <option value="CONTACT CLEAN/INSPECT">CONTACT CLEAN/INSPECT</option>
                <option value="REPLACE SOCKET">REPLACE SOCKET</option>
                <option value="HANDLER ISSUE">HANDLER ISSUE</option>
                <option value="POWERCYCLE">POWERCYCLE</option>
                <option value="LPE">LPE</option>
                <option value="DYLPS">DYLPS</option>
                <option value="DYSER">DYSER</option>
                <option value="TEST PROGRAM">TEST PROGRAM</option>
                <option value="TEMP PROBLEM">TEMP PROBLEM</option>
            </select>
    
            <label for="comment">Comment:</label>
            <textarea id="comment" name="comment" rows="4"></textarea>
    
            <label for="employeeId">Employee ID:</label>
            <input type="number" id="employeeId" name="employeeId" required>
    
            <button type="submit">Log Failure</button>
        </form>
    
        <!-- Button to export to Excel -->
        <button id="exportExcel" onclick="exportToExcel()">Export to Excel</button>
    
        <!-- Search Filter -->
        <input type="text" id="searchFilter" placeholder="Search ..." onkeyup="filterFailures()">
    
        <div class="table-container">
            <h2>Logged Failures</h2>
            <table id="failureTable">
                <thead>
                    <tr>
                        <th>Timestamp</th>
                        <th>Tester ID</th>
                        <th>MTF Bin</th>
                        <th>Test Name</th>
                        <th>Test Number</th>
                        <th>Die type</th>
                        <th>Job Reason</th>
                        <th>Comment</th>
                        <th>Employee ID</th>
                        <th></th>
                    </tr>
                </thead>
                <tbody>
                    <!-- Logged data will appear here -->
                </tbody>
            </table>
        </div>
    </div>
    

    <script src="script.js"></script>
</body>
</html>
